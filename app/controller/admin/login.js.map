{
    "version": 3,
    "sources": [
        "../../../src/controller/admin/login.js"
    ],
    "names": [
        "Base",
        "require",
        "jwt",
        "module",
        "exports",
        "indexAction",
        "username",
        "post",
        "password",
        "userService",
        "service",
        "user",
        "getAdminByUsername",
        "fail",
        "think",
        "md5",
        "tokenData",
        "email",
        "user_ID",
        "id",
        "JSON",
        "stringify",
        "token",
        "sign",
        "data",
        "tokenService",
        "result",
        "saveToken",
        "cookie",
        "maxAge",
        "httpOnly",
        "success"
    ],
    "mappings": ";;AAAA,MAAMA,OAAOC,QAAQ,YAAR,CAAb;;AAEA,IAAIC,MAAMD,QAAQ,cAAR,CAAV;;AAEAE,OAAOC,OAAP,GAAiB,cAAcJ,IAAd,CAAmB;AAC1BK,eAAN,GAAoB;AAAA;;AAAA;AAChB,gBAAIC,WAAW,MAAKC,IAAL,CAAU,UAAV,CAAf;AACA,gBAAIC,WAAW,MAAKD,IAAL,CAAU,UAAV,CAAf;AACA,gBAAIE,cAAc,MAAKC,OAAL,CAAa,MAAb,CAAlB;AACA,gBAAIC,OAAO,MAAMF,YAAYG,kBAAZ,CAA+BN,QAA/B,CAAjB;AACA,gBAAI,CAACK,KAAKL,QAAV,EAAoB;AAChB,uBAAO,MAAKO,IAAL,CAAU,IAAV,EAAgB,OAAhB,CAAP;AACH;AACDL,uBAAWM,MAAMC,GAAN,CAAUP,QAAV,CAAX;AACA,gBAAIA,aAAaG,KAAKH,QAAtB,EAAgC;AAC5B,uBAAO,MAAKK,IAAL,CAAU,IAAV,EAAgB,MAAhB,CAAP;AACH;AACD,gBAAIG,YAAY;AACZV,0BAAUK,KAAKL,QADH;AAEZW,uBAAON,KAAKM,KAFA;AAGZC,yBAASP,KAAKQ;AAHF,aAAhB;AAKAH,wBAAYI,KAAKC,SAAL,CAAeL,SAAf,CAAZ;AACAA,wBAAYF,MAAMC,GAAN,CAAUC,SAAV,CAAZ;AACA,gBAAIM,QAAQpB,IAAIqB,IAAJ,CAAS,EAAEC,MAAMR,SAAR,EAAT,EAA6B,QAA7B,CAAZ;AACA,gBAAIS,eAAe,MAAKf,OAAL,CAAa,OAAb,CAAnB;AACA,gBAAIgB,SAAS,MAAMD,aAAaE,SAAb,CAAuBL,KAAvB,EAA8BX,KAAKQ,EAAnC,CAAnB;AACA,kBAAKS,MAAL,CAAY,UAAZ,EACIR,KAAKC,SAAL,CAAe,EAACf,UAAUK,KAAKL,QAAhB,EAA0BgB,OAAOA,KAAjC,EAAf,CADJ,EAC6D;AACrDO,wBAAQ,SAAS,EADoC;AAErDC,0BAAU;AAF2C,aAD7D;AAKA,mBAAO,MAAKC,OAAL,CAAa,EAACT,OAAOA,KAAR,EAAb,EAA6B,MAA7B,CAAP;AA3BgB;AA4BnB;AA7B+B,CAApC",
    "file": "../../../src/controller/admin/login.js",
    "sourcesContent": [
        "const Base = require('../base.js');\n\nlet jwt = require('jsonwebtoken');\n\nmodule.exports = class extends Base {\n    async indexAction() {\n        let username = this.post('username');\n        let password = this.post('password');\n        let userService = this.service('user');\n        let user = await userService.getAdminByUsername(username);\n        if (!user.username) {\n            return this.fail(2000, '用户不存在');\n        }\n        password = think.md5(password);\n        if (password !== user.password) {\n            return this.fail(2001, '密码错误');\n        }\n        let tokenData = {\n            username: user.username,\n            email: user.email,\n            user_ID: user.id\n        };\n        tokenData = JSON.stringify(tokenData);\n        tokenData = think.md5(tokenData);\n        let token = jwt.sign({ data: tokenData}, 'Jeremy');\n        let tokenService = this.service('token');\n        let result = await tokenService.saveToken(token, user.id);\n        this.cookie('userinfo',\n            JSON.stringify({username: user.username, token: token}), {\n                maxAge: 360000 * 12,\n                httpOnly: false\n        });\n        return this.success({token: token}, '登录成功');\n    }\n};\n"
    ]
}